{"version":3,"sources":["../src/callback.ts","../src/logoutRoute.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\n\nexport function createCallbackGET() {\n    return async (request: NextRequest) => {\n        const accessToken = request.nextUrl.searchParams.get('token')\n        const redirectTo = request.nextUrl.searchParams.get('redirect') || '/'\n\n        if (!accessToken) {\n            return NextResponse.redirect(new URL('/login', request.url))\n        }\n\n        const response = NextResponse.redirect(new URL(redirectTo, request.url))\n\n        // Store access token in httpOnly cookie\n        response.cookies.set('access_token', accessToken, {\n            httpOnly: true,\n            secure: process.env.NODE_ENV === 'production',\n            sameSite: 'lax',\n            maxAge: 60 * 15, // 15 minutes (match token expiry)\n            path: '/'\n        })\n\n        return response\n    }\n}\n","import { NextResponse } from 'next/server'\n\nexport function createLogoutPOST() {\n    return async () => {\n        const response = NextResponse.json({ success: true })\n\n        // Clear the httpOnly cookie by setting it with maxAge: 0\n        response.cookies.set('access_token', '', {\n            httpOnly: true,\n            secure: process.env.NODE_ENV === 'production',\n            sameSite: 'lax',\n            maxAge: 0,\n            path: '/'\n        })\n\n        return response\n    }\n}\n"],"mappings":";AAAA,SAAsB,oBAAoB;AAEnC,SAAS,oBAAoB;AAChC,SAAO,OAAO,YAAyB;AACnC,UAAM,cAAc,QAAQ,QAAQ,aAAa,IAAI,OAAO;AAC5D,UAAM,aAAa,QAAQ,QAAQ,aAAa,IAAI,UAAU,KAAK;AAEnE,QAAI,CAAC,aAAa;AACd,aAAO,aAAa,SAAS,IAAI,IAAI,UAAU,QAAQ,GAAG,CAAC;AAAA,IAC/D;AAEA,UAAM,WAAW,aAAa,SAAS,IAAI,IAAI,YAAY,QAAQ,GAAG,CAAC;AAGvE,aAAS,QAAQ,IAAI,gBAAgB,aAAa;AAAA,MAC9C,UAAU;AAAA,MACV,QAAQ,QAAQ,IAAI,aAAa;AAAA,MACjC,UAAU;AAAA,MACV,QAAQ,KAAK;AAAA;AAAA,MACb,MAAM;AAAA,IACV,CAAC;AAED,WAAO;AAAA,EACX;AACJ;;;ACxBA,SAAS,gBAAAA,qBAAoB;AAEtB,SAAS,mBAAmB;AAC/B,SAAO,YAAY;AACf,UAAM,WAAWA,cAAa,KAAK,EAAE,SAAS,KAAK,CAAC;AAGpD,aAAS,QAAQ,IAAI,gBAAgB,IAAI;AAAA,MACrC,UAAU;AAAA,MACV,QAAQ,QAAQ,IAAI,aAAa;AAAA,MACjC,UAAU;AAAA,MACV,QAAQ;AAAA,MACR,MAAM;AAAA,IACV,CAAC;AAED,WAAO;AAAA,EACX;AACJ;","names":["NextResponse"]}